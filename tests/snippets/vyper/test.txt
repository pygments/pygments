---input---
# @version 0.3.7
"""
@title crvUSD Stablecoin
@author Curve.Fi
@license Copyright (c) Curve.Fi, 2020-2023 - all rights reserved
"""
from vyper.interfaces import ERC20

implements: ERC20


interface ERC1271:
    def isValidSignature(_hash: bytes32, _signature: Bytes[65]) -> bytes4: view


event Approval:
    owner: indexed(address)
    spender: indexed(address)
    value: uint256

event Transfer:
    sender: indexed(address)
    receiver: indexed(address)
    value: uint256

event SetMinter:
    minter: indexed(address)


decimals: public(constant(uint8)) = 18
version: public(constant(String[8])) = "v1.0.0"

ERC1271_MAGIC_VAL: constant(bytes4) = 0x1626ba7e
EIP712_TYPEHASH: constant(bytes32) = keccak256(
    "EIP712Domain(string name,string version,uint256 chainId,address verifyingContract,bytes32 salt)"
)
EIP2612_TYPEHASH: constant(bytes32) = keccak256(
    "Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)"
)
VERSION_HASH: constant(bytes32) = keccak256(version)


name: public(immutable(String[64]))
symbol: public(immutable(String[32]))
salt: public(immutable(bytes32))

NAME_HASH: immutable(bytes32)
CACHED_CHAIN_ID: immutable(uint256)
CACHED_DOMAIN_SEPARATOR: immutable(bytes32)


allowance: public(HashMap[address, HashMap[address, uint256]])
balanceOf: public(HashMap[address, uint256])
totalSupply: public(uint256)

nonces: public(HashMap[address, uint256])
minter: public(address)


@external
def __init__(_name: String[64], _symbol: String[32]):
    name = _name
    symbol = _symbol

    NAME_HASH = keccak256(_name)
    CACHED_CHAIN_ID = chain.id
    salt = block.prevhash
    CACHED_DOMAIN_SEPARATOR = keccak256(
        _abi_encode(
            EIP712_TYPEHASH,
            keccak256(_name),
            VERSION_HASH,
            chain.id,
            self,
            block.prevhash,
        )
    )

    self.minter = msg.sender
    log SetMinter(msg.sender)


@internal
def _approve(_owner: address, _spender: address, _value: uint256):
    self.allowance[_owner][_spender] = _value

    log Approval(_owner, _spender, _value)

---tokens---
'# @version 0.3.7' Comment.Single
'\n'          Text.Whitespace

'"""'         Comment.Multiline
'\n'          Comment.Multiline

'@'           Comment.Multiline
't'           Comment.Multiline
'i'           Comment.Multiline
't'           Comment.Multiline
'l'           Comment.Multiline
'e'           Comment.Multiline
' '           Comment.Multiline
'c'           Comment.Multiline
'r'           Comment.Multiline
'v'           Comment.Multiline
'U'           Comment.Multiline
'S'           Comment.Multiline
'D'           Comment.Multiline
' '           Comment.Multiline
'S'           Comment.Multiline
't'           Comment.Multiline
'a'           Comment.Multiline
'b'           Comment.Multiline
'l'           Comment.Multiline
'e'           Comment.Multiline
'c'           Comment.Multiline
'o'           Comment.Multiline
'i'           Comment.Multiline
'n'           Comment.Multiline
'\n'          Comment.Multiline

'@'           Comment.Multiline
'a'           Comment.Multiline
'u'           Comment.Multiline
't'           Comment.Multiline
'h'           Comment.Multiline
'o'           Comment.Multiline
'r'           Comment.Multiline
' '           Comment.Multiline
'C'           Comment.Multiline
'u'           Comment.Multiline
'r'           Comment.Multiline
'v'           Comment.Multiline
'e'           Comment.Multiline
'.'           Comment.Multiline
'F'           Comment.Multiline
'i'           Comment.Multiline
'\n'          Comment.Multiline

'@'           Comment.Multiline
'l'           Comment.Multiline
'i'           Comment.Multiline
'c'           Comment.Multiline
'e'           Comment.Multiline
'n'           Comment.Multiline
's'           Comment.Multiline
'e'           Comment.Multiline
' '           Comment.Multiline
'C'           Comment.Multiline
'o'           Comment.Multiline
'p'           Comment.Multiline
'y'           Comment.Multiline
'r'           Comment.Multiline
'i'           Comment.Multiline
'g'           Comment.Multiline
'h'           Comment.Multiline
't'           Comment.Multiline
' '           Comment.Multiline
'('           Comment.Multiline
'c'           Comment.Multiline
')'           Comment.Multiline
' '           Comment.Multiline
'C'           Comment.Multiline
'u'           Comment.Multiline
'r'           Comment.Multiline
'v'           Comment.Multiline
'e'           Comment.Multiline
'.'           Comment.Multiline
'F'           Comment.Multiline
'i'           Comment.Multiline
','           Comment.Multiline
' '           Comment.Multiline
'2'           Comment.Multiline
'0'           Comment.Multiline
'2'           Comment.Multiline
'0'           Comment.Multiline
'-'           Comment.Multiline
'2'           Comment.Multiline
'0'           Comment.Multiline
'2'           Comment.Multiline
'3'           Comment.Multiline
' '           Comment.Multiline
'-'           Comment.Multiline
' '           Comment.Multiline
'a'           Comment.Multiline
'l'           Comment.Multiline
'l'           Comment.Multiline
' '           Comment.Multiline
'r'           Comment.Multiline
'i'           Comment.Multiline
'g'           Comment.Multiline
'h'           Comment.Multiline
't'           Comment.Multiline
's'           Comment.Multiline
' '           Comment.Multiline
'r'           Comment.Multiline
'e'           Comment.Multiline
's'           Comment.Multiline
'e'           Comment.Multiline
'r'           Comment.Multiline
'v'           Comment.Multiline
'e'           Comment.Multiline
'd'           Comment.Multiline
'\n'          Comment.Multiline

'"""'         Comment.Multiline
'\n'          Text.Whitespace

'from'        Keyword.Namespace
' '           Text.Whitespace
'vyper.interfaces' Name.Namespace
' '           Text.Whitespace
'import'      Keyword.Namespace
' '           Text.Whitespace
'ERC20'       Name.Namespace
'\n\n'        Text.Whitespace

'implements'  Name.Namespace
''            Punctuation
':'           Error
' '           Text.Whitespace
'ERC20'       Name.Namespace
'\n\n\n'      Text.Whitespace

'interface'   Name.Namespace
' '           Text.Whitespace
'ERC1271'     Name.Namespace
':'           Error
'\n    '      Text.Whitespace
'def'         Name.Namespace
' '           Text.Whitespace
'isValidSignature' Name.Namespace
'('           Error
'_hash'       Name.Namespace
':'           Error
' '           Text.Whitespace
'bytes32'     Name.Namespace
','           Error
' '           Text.Whitespace
'_signature'  Name.Namespace
':'           Error
' '           Text.Whitespace
'Bytes'       Name.Namespace
'['           Error
'6'           Error
'5'           Error
']'           Error
')'           Error
' '           Text.Whitespace
'-'           Error
'>'           Error
' '           Text.Whitespace
'bytes4'      Name.Namespace
':'           Error
' '           Text.Whitespace
'view'        Name.Namespace
'\n\n\n'      Text.Whitespace

'event'       Name.Namespace
' '           Text.Whitespace
'Approval'    Name.Namespace
':'           Error
'\n    '      Text.Whitespace
'owner'       Name.Namespace
':'           Error
' '           Text.Whitespace
'indexed'     Name.Namespace
'('           Error
'address'     Name.Namespace
')'           Error
'\n    '      Text.Whitespace
'spender'     Name.Namespace
':'           Error
' '           Text.Whitespace
'indexed'     Name.Namespace
'('           Error
'address'     Name.Namespace
')'           Error
'\n    '      Text.Whitespace
'value'       Name.Namespace
':'           Error
' '           Text.Whitespace
'uint256'     Name.Namespace
'\n\n'        Text.Whitespace

'event'       Name.Namespace
' '           Text.Whitespace
'Transfer'    Name.Namespace
':'           Error
'\n    '      Text.Whitespace
'sender'      Name.Namespace
':'           Error
' '           Text.Whitespace
'indexed'     Name.Namespace
'('           Error
'address'     Name.Namespace
')'           Error
'\n    '      Text.Whitespace
'receiver'    Name.Namespace
':'           Error
' '           Text.Whitespace
'indexed'     Name.Namespace
'('           Error
'address'     Name.Namespace
')'           Error
'\n    '      Text.Whitespace
'value'       Name.Namespace
':'           Error
' '           Text.Whitespace
'uint256'     Name.Namespace
'\n\n'        Text.Whitespace

'event'       Name.Namespace
' '           Text.Whitespace
'SetMinter'   Name.Namespace
':'           Error
'\n    '      Text.Whitespace
'minter'      Name.Namespace
':'           Error
' '           Text.Whitespace
'indexed'     Name.Namespace
'('           Error
'address'     Name.Namespace
')'           Error
'\n\n\n'      Text.Whitespace

'decimals'    Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'constant'    Name.Namespace
'('           Error
'uint8'       Name.Namespace
')'           Error
')'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'1'           Error
'8'           Error
'\n'          Text.Whitespace

'version'     Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'constant'    Name.Namespace
'('           Error
'String'      Name.Namespace
'['           Error
'8'           Error
']'           Error
')'           Error
')'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'"'           Error
'v1.0.0'      Name.Namespace
'"'           Error
'\n\n'        Text.Whitespace

'ERC1271_MAGIC_VAL' Name.Namespace
':'           Error
' '           Text.Whitespace
'constant'    Name.Namespace
'('           Error
'bytes4'      Name.Namespace
')'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'0'           Error
'x1626ba7e'   Name.Namespace
'\n'          Text.Whitespace

'EIP712_TYPEHASH' Name.Namespace
':'           Error
' '           Text.Whitespace
'constant'    Name.Namespace
'('           Error
'bytes32'     Name.Namespace
')'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'keccak256'   Name.Namespace
'('           Error
'\n    '      Text.Whitespace
'"'           Error
'EIP712Domain' Name.Namespace
'('           Error
'string'      Name.Namespace
' '           Text.Whitespace
'name'        Name.Namespace
','           Error
'string'      Name.Namespace
' '           Text.Whitespace
'version'     Name.Namespace
','           Error
'uint256'     Name.Namespace
' '           Text.Whitespace
'chainId'     Name.Namespace
','           Error
'address'     Name.Namespace
' '           Text.Whitespace
'verifyingContract' Name.Namespace
','           Error
'bytes32'     Name.Namespace
' '           Text.Whitespace
'salt'        Name.Namespace
')'           Error
'"'           Error
'\n'          Text.Whitespace

')'           Error
'\n'          Text.Whitespace

'EIP2612_TYPEHASH' Name.Namespace
':'           Error
' '           Text.Whitespace
'constant'    Name.Namespace
'('           Error
'bytes32'     Name.Namespace
')'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'keccak256'   Name.Namespace
'('           Error
'\n    '      Text.Whitespace
'"'           Error
'Permit'      Name.Namespace
'('           Error
'address'     Name.Namespace
' '           Text.Whitespace
'owner'       Name.Namespace
','           Error
'address'     Name.Namespace
' '           Text.Whitespace
'spender'     Name.Namespace
','           Error
'uint256'     Name.Namespace
' '           Text.Whitespace
'value'       Name.Namespace
','           Error
'uint256'     Name.Namespace
' '           Text.Whitespace
'nonce'       Name.Namespace
','           Error
'uint256'     Name.Namespace
' '           Text.Whitespace
'deadline'    Name.Namespace
')'           Error
'"'           Error
'\n'          Text.Whitespace

')'           Error
'\n'          Text.Whitespace

'VERSION_HASH' Name.Namespace
':'           Error
' '           Text.Whitespace
'constant'    Name.Namespace
'('           Error
'bytes32'     Name.Namespace
')'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'keccak256'   Name.Namespace
'('           Error
'version'     Name.Namespace
')'           Error
'\n\n\n'      Text.Whitespace

'name'        Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'immutable'   Name.Namespace
'('           Error
'String'      Name.Namespace
'['           Error
'6'           Error
'4'           Error
']'           Error
')'           Error
')'           Error
'\n'          Text.Whitespace

'symbol'      Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'immutable'   Name.Namespace
'('           Error
'String'      Name.Namespace
'['           Error
'3'           Error
'2'           Error
']'           Error
')'           Error
')'           Error
'\n'          Text.Whitespace

'salt'        Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'immutable'   Name.Namespace
'('           Error
'bytes32'     Name.Namespace
')'           Error
')'           Error
'\n\n'        Text.Whitespace

'NAME_HASH'   Name.Namespace
':'           Error
' '           Text.Whitespace
'immutable'   Name.Namespace
'('           Error
'bytes32'     Name.Namespace
')'           Error
'\n'          Text.Whitespace

'CACHED_CHAIN_ID' Name.Namespace
':'           Error
' '           Text.Whitespace
'immutable'   Name.Namespace
'('           Error
'uint256'     Name.Namespace
')'           Error
'\n'          Text.Whitespace

'CACHED_DOMAIN_SEPARATOR' Name.Namespace
':'           Error
' '           Text.Whitespace
'immutable'   Name.Namespace
'('           Error
'bytes32'     Name.Namespace
')'           Error
'\n\n\n'      Text.Whitespace

'allowance'   Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'HashMap'     Name.Namespace
'['           Error
'address'     Name.Namespace
','           Error
' '           Text.Whitespace
'HashMap'     Name.Namespace
'['           Error
'address'     Name.Namespace
','           Error
' '           Text.Whitespace
'uint256'     Name.Namespace
']'           Error
']'           Error
')'           Error
'\n'          Text.Whitespace

'balanceOf'   Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'HashMap'     Name.Namespace
'['           Error
'address'     Name.Namespace
','           Error
' '           Text.Whitespace
'uint256'     Name.Namespace
']'           Error
')'           Error
'\n'          Text.Whitespace

'totalSupply' Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'uint256'     Name.Namespace
')'           Error
'\n\n'        Text.Whitespace

'nonces'      Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'HashMap'     Name.Namespace
'['           Error
'address'     Name.Namespace
','           Error
' '           Text.Whitespace
'uint256'     Name.Namespace
']'           Error
')'           Error
'\n'          Text.Whitespace

'minter'      Name.Namespace
':'           Error
' '           Text.Whitespace
'public'      Name.Namespace
'('           Error
'address'     Name.Namespace
')'           Error
'\n\n\n'      Text.Whitespace

'@'           Error
'external'    Name.Namespace
'\n'          Text.Whitespace

'def'         Name.Namespace
' '           Text.Whitespace
'__init__'    Name.Namespace
'('           Error
'_name'       Name.Namespace
':'           Error
' '           Text.Whitespace
'String'      Name.Namespace
'['           Error
'6'           Error
'4'           Error
']'           Error
','           Error
' '           Text.Whitespace
'_symbol'     Name.Namespace
':'           Error
' '           Text.Whitespace
'String'      Name.Namespace
'['           Error
'3'           Error
'2'           Error
']'           Error
')'           Error
':'           Error
'\n    '      Text.Whitespace
'name'        Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'_name'       Name.Namespace
'\n    '      Text.Whitespace
'symbol'      Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'_symbol'     Name.Namespace
'\n\n    '    Text.Whitespace
'NAME_HASH'   Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'keccak256'   Name.Namespace
'('           Error
'_name'       Name.Namespace
')'           Error
'\n    '      Text.Whitespace
'CACHED_CHAIN_ID' Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'chain.id'    Name.Namespace
'\n    '      Text.Whitespace
'salt'        Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'block.prevhash' Name.Namespace
'\n    '      Text.Whitespace
'CACHED_DOMAIN_SEPARATOR' Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'keccak256'   Name.Namespace
'('           Error
'\n        '  Text.Whitespace
'_abi_encode' Name.Namespace
'('           Error
'\n            ' Text.Whitespace
'EIP712_TYPEHASH' Name.Namespace
','           Error
'\n            ' Text.Whitespace
'keccak256'   Name.Namespace
'('           Error
'_name'       Name.Namespace
')'           Error
','           Error
'\n            ' Text.Whitespace
'VERSION_HASH' Name.Namespace
','           Error
'\n            ' Text.Whitespace
'chain.id'    Name.Namespace
','           Error
'\n            ' Text.Whitespace
'self'        Name.Namespace
','           Error
'\n            ' Text.Whitespace
'block.prevhash' Name.Namespace
','           Error
'\n        '  Text.Whitespace
')'           Error
'\n    '      Text.Whitespace
')'           Error
'\n\n    '    Text.Whitespace
'self.minter' Name.Namespace
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'msg.sender'  Name.Namespace
'\n    '      Text.Whitespace
'log'         Name.Namespace
' '           Text.Whitespace
'SetMinter'   Name.Namespace
'('           Error
'msg.sender'  Name.Namespace
')'           Error
'\n\n\n'      Text.Whitespace

'@'           Error
'internal'    Name.Namespace
'\n'          Text.Whitespace

'def'         Name.Namespace
' '           Text.Whitespace
'_approve'    Name.Namespace
'('           Error
'_owner'      Name.Namespace
':'           Error
' '           Text.Whitespace
'address'     Name.Namespace
','           Error
' '           Text.Whitespace
'_spender'    Name.Namespace
':'           Error
' '           Text.Whitespace
'address'     Name.Namespace
','           Error
' '           Text.Whitespace
'_value'      Name.Namespace
':'           Error
' '           Text.Whitespace
'uint256'     Name.Namespace
')'           Error
':'           Error
'\n    '      Text.Whitespace
'self.allowance' Name.Namespace
'['           Error
'_owner'      Name.Namespace
']'           Error
'['           Error
'_spender'    Name.Namespace
']'           Error
' '           Text.Whitespace
'='           Error
' '           Text.Whitespace
'_value'      Name.Namespace
'\n\n    '    Text.Whitespace
'log'         Name.Namespace
' '           Text.Whitespace
'Approval'    Name.Namespace
'('           Error
'_owner'      Name.Namespace
','           Error
' '           Text.Whitespace
'_spender'    Name.Namespace
','           Error
' '           Text.Whitespace
'_value'      Name.Namespace
')'           Error
'\n'          Text.Whitespace
